---

copyright:
  years: 2017, 2019
lastupdated: "2019-03-15"

keywords: apps, best practices

subcollection: creating-apps

---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}
{:tip: .tip}
{:note: .note}

# 良いアプリを作成するには
{: #best-practice}

クラウドが提供するすべてのものを活用するように {{site.data.keyword.cloud}} でアプリをビルドします。 以下のベスト・プラクティスは、アプリが確実にクラウド対応となるようにするのに役立ちます。
{: shortdesc}

## トポロジーから独立したアプリケーションの作成

非クラウド環境では、アプリは特定のデプロイメント・トポロジーを使用する場合があります。 しかし、クラウド対応のアプリおよびサービスは即時のスケーラビリティーの変更を許容するため、アプリ・トポロジーはクラウド・アプリでは変わる可能性があります。 これらの変更には、動的なスケーリングと、手動でのアプリのインスタンス数の変更があります。

スケーラビリティー変更によってアプリが影響を受けないように、アプリをできるだけ汎用的かつステートレスになるようビルドしてください。

## ローカル・ファイル・システムは永続的ではないと見なすこと

アプリ・インスタンスはクラウド上で移動、削除、複製される可能性があるため、ファイル・システムに書き込まれたファイルに依存しないようにしてください。 頻繁に使用される情報 (アプリ・ログなど) のキャッシュとしてアプリがローカル・ファイル・システムを使用する場合、その情報は、インスタンスがシャットダウンされ、別の場所または別の VM で再始動されると失われます。

ローカル・ファイル・システムの代わりに、SQL または NoSQL データベースなどのサービスに情報を保管できます。 動的クラウド環境では、ログが生成されるアプリ・インスタンスよりも長く存続するサービスでログを使用可能にしておくことも重要です。

## アプリからのセッション状態の除外

システムの状態は、実行中の個々のアプリ・インスタンスではなく、データベースおよび共有ストレージによって定義されます。 ステートフルであるという性質はどのような種類であっても、アプリの拡張性を制限します。 サーバー上の集中管理される場所にセッション状態を保管することによって、セッション状態の影響を最小化するようにしてください。

セッション状態を完全に除去できない場合は、アプリ・サーバーの外部にある可用性の高い保管場所にセッション状態を格納してください。 その保管場所としては、IBM WebSphere eXtreme Scale、Redis、Memcached、外部データベースなどがあります。

## 外部サービス・レジストリーを使用したサービス・エンドポイントの解決

アプリが使用するサービスに特定のホスト名または IP アドレスが割り振られていると想定しないでください。 それらのサービスはクラウド環境では再配置されたり再生成されたりする可能性があり、ホスト名および IP アドレスも変わる可能性があります。

環境特有の依存関係を一連のプロパティー・ファイルに抽出することは改善ではありますが、まだ不十分です。 ベスト・プラクティスは、外部サービス・レジストリーを使用してサービス・エンドポイントを解決することか、または、ルーティング機能全体を仮想名を持つ 1 つのサービス・バスまたはロード・バランサーに委任することです。

## マルチリージョン・アーキテクチャーを使用したアプリのビルド
{: #multiregion}

単一地域でのダウン時間を回避するために、複数のインスタンスを実行できます。 より堅固なアプリケーションを提供するには、複数地域アーキテクチャーを検討してください。

ダウン時間の最小化および最大限の可用性を実現する回復力のあるアーキテクチャーの作成について詳しくは、[回復力のあるアプリケーションのための戦略 (Strategies for resilient applications) のチュートリアル](/docs/tutorials?topic=solution-tutorials-strategies-for-resilient-applications)を参照してください。

## アプリのモニタリングの確実な実施
{: #monitoring}

{{site.data.keyword.cloud_notm}} は、[New Relic ](http://newrelic.com/){: new_window} ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン") などのサービスを使用してアプリケーションのモニタリングを容易にします。

## サポート・オプションの利用
{: #support}

{{site.data.keyword.cloud_notm}} の有料プランでは、オプションの有料サポートを含むさまざまなアカウント・タイプが提供されています。 ご使用のアカウント・タイプに関係なく、{{site.data.keyword.cloud_notm}} でのアプリケーションの実稼働を予定している場合は、このオプションの登録を検討してください。

有料サポートを契約しているかどうかに関係なく、[サポート](/docs/get-support?topic=get-support-getting-customer-support)に記載されている支援を受けることができます。サポートは予期しない問題に対する備えを提供します。

## アプリケーションでのインフラストラクチャー API の回避

インフラストラクチャー API はソフトウェア・スタック内の多くのさまざまなレイヤーを参照することがあるため、アプリ内で特定のインフラストラクチャー API に依存している場合、そのインフラストラクチャーの変更がより難しいものになります。

代わりに、既存のオープン・ソース製品または市販製品に依存し、PaaS ソリューションは PaaS レイヤーに残したままにしてアプリ・コードの外に保持するようにできます。

## 標準プロトコルの使用

回復力のために余分な構成を必要とするようなあいまいなプロトコルを使用しないでください。

標準プロトコルに基づくアプリのほうが、構成項目をプラットフォームに委任でき、より回復力があります。 標準プロトコルには、HTTP、SSL、標準データベース、キューイング、Web サービス接続などがあります。

## OS 固有の機能でなく互換ライブラリーの使用

既に OS 固有の機能を使用している場合は、例えば Cygwin および Monoなどの互換ライブラリーを使用して、この問題を修正できます。 Cygwin は、Windows 環境で Linux ツールのセットを提供する互換ライブラリーです。 Mono は、Linux で Windows .NET ツールを提供する互換ライブラリーです。

OS 固有の依存関係を避けて、代わりにミドルウェア・インフラストラクチャーまたはサービス・プロバイダーによって提供されるサービスを使用してください。

## インストール・プロセスのスクリプト化

動的クラウド環境では、アプリがオンデマンドで頻繁にインストールされる可能性があります。 インストール・プロセスはスクリプト化されて信頼できるものでなければならず、構成データはスクリプトの外部に置く必要があります。

アプリのインストール済み環境は、オペレーティング・システムから独立した、一様なスクリプトの一式と捉えてください。 さまざまな自動化技法に適応できるよう、アプリのインストールを小さくポータブルなものにしてください。 また、アプリのインストールに必要な依存関係を最小限にしてください。

クラウド対応のアプリについて詳しくは、[The 12-factor app ](http://12factor.net/){: new_window} ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン") を参照してください。


